if("undefined"==typeof MIDI)var MIDI={};if(function(){"use strict";var e={},n=function(n){var t=new Audio,r=n.split(";")[0];t.id="audio",t.setAttribute("preload","auto"),t.setAttribute("audiobuffer",!0),t.addEventListener("canplaythrough",function(){e[r]=!0},!1),t.src="data:"+n,document.body.appendChild(t)};MIDI.audioDetect=function(t){if("undefined"==typeof Audio)return t({});var r=new Audio;if("undefined"==typeof r.canPlayType)return t(e);var o=r.canPlayType('audio/ogg; codecs="vorbis"');o="probably"===o||"maybe"===o;var a=r.canPlayType("audio/mpeg");if(a="probably"===a||"maybe"===a,!o&&!a)return void t(e);o&&n("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),a&&n("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var i=(new Date).getTime(),u=window.setInterval(function(){for(var n in e);var r=(new Date).getTime(),o=r-i>5e3;(n||o)&&(window.clearInterval(u),t(e))},1)}}(),"undefined"==typeof MIDI)var MIDI={};if("undefined"==typeof MIDI.Soundfont&&(MIDI.Soundfont={}),function(){"use strict";var e=!1;MIDI.loadPlugin=function(e){"function"==typeof e&&(e={callback:e});var r=e.instruments||e.instrument||"acoustic_grand_piano";"object"!=typeof r&&(r=[r]),r.map(function(e){return"number"==typeof e&&(e=MIDI.GeneralMIDI.byId[e]),e}),MIDI.soundfontUrl=e.soundfontUrl||MIDI.soundfontUrl||"./soundfont/",MIDI.audioDetect(function(o){var a="";if("undefined"==typeof a&&(a=t[window.location.hash]?window.location.hash.substr(1):""),""===a&&(a=navigator.requestMIDIAccess?"webmidi":window.webkitAudioContext?"webaudio":window.Audio?"audiotag":"flash"),n[a]){var i=o["audio/ogg"]?"ogg":"mp3";n[a](i,r,e.callback)}})};var n={};n.webmidi=function(e,n,t){MIDI.loader&&MIDI.loader.message("Web MIDI API..."),MIDI.WebMIDI.connect(t)},n.flash=function(e,n,t){MIDI.loader&&MIDI.loader.message("Flash API..."),DOMLoader.script.add({src:"./inc/SoundManager2/script/soundmanager2.js",verify:"SoundManager",callback:function(){MIDI.Flash.connect(t)}})},n.audiotag=function(n,t,a){MIDI.loader&&MIDI.loader.message("HTML5 Audio API...");var i=o({items:t,getNext:function(t){e?DOMLoader.sendRequest({url:MIDI.soundfontUrl+t+"-"+n+".js",onprogress:r,onload:function(e){MIDI.Soundfont[t]=JSON.parse(e.responseText),MIDI.loader&&MIDI.loader.update(null,"Downloading",100),i.getNext()}}):DOMLoader.script.add({src:MIDI.soundfontUrl+t+"-"+n+".js",verify:"MIDI.Soundfont."+t,callback:function(){MIDI.loader&&MIDI.loader.update(null,"Downloading...",100),i.getNext()}})},onComplete:function(){MIDI.AudioTag.connect(a)}})},n.webaudio=function(n,t,a){MIDI.loader&&MIDI.loader.message("Web Audio API...");var i=o({items:t,getNext:function(t){e?DOMLoader.sendRequest({url:MIDI.soundfontUrl+t+"-"+n+".js",onprogress:r,onload:function(e){MIDI.Soundfont[t]=JSON.parse(e.responseText),MIDI.loader&&MIDI.loader.update(null,"Downloading...",100),i.getNext()}}):DOMLoader.script.add({src:MIDI.soundfontUrl+t+"-"+n+".js",verify:"MIDI.Soundfont."+t,callback:function(){MIDI.loader&&MIDI.loader.update(null,"Downloading...",100),i.getNext()}})},onComplete:function(){MIDI.WebAudioAPI.connect(a)}})};var t={"#webmidi":!0,"#webaudio":!0,"#audiotag":!0,"#flash":!0},r=function(e){this.totalSize||(this.totalSize=this.getResponseHeader("Content-Length-Raw")?parseInt(this.getResponseHeader("Content-Length-Raw")):e.total);var n=this.totalSize?Math.round(e.loaded/this.totalSize*100):"";MIDI.loader&&MIDI.loader.update(null,"Downloading...",n)},o=function(e){var n={};n.queue=[];for(var t in e.items)n.queue.push(e.items[t]);return n.getNext=function(){return n.queue.length?void e.getNext(n.queue.shift()):e.onComplete()},setTimeout(n.getNext,1),n}}(),"undefined"==typeof MIDI)var MIDI={};if(function(){"use strict";!function(){var e=null,n=null,t=[],r=MIDI.WebMIDI={};r.setVolume=function(e,t){n.send([176+e,7,t])},r.programChange=function(e,t){n.send([192+e,t])},r.noteOn=function(e,t,r,o){n.send([144+e,t,r],1e3*o)},r.noteOff=function(e,t,r){n.send([128+e,t],1e3*r)},r.chordOn=function(e,t,r,o){for(var a=0;a<t.length;a++){var i=t[a];n.send([144+e,i,r],1e3*o)}},r.chordOff=function(e,t,r){for(var o=0;o<t.length;o++){var a=t[o];n.send([128,e,a,velocity],1e3*r)}},r.stopAllNotes=function(){for(var e=0;16>e;e++)n.send([176+e,123,0])},r.getInput=function(){return e.getInputs()},r.getOutputs=function(){return e.getOutputs()},r.connect=function(t){MIDI.technology="Web MIDI API",MIDI.setVolume=r.setVolume,MIDI.programChange=r.programChange,MIDI.noteOn=r.noteOn,MIDI.noteOff=r.noteOff,MIDI.chordOn=r.chordOn,MIDI.chordOff=r.chordOff,MIDI.stopAllNotes=r.stopAllNotes,MIDI.getInput=r.getInput,MIDI.getOutputs=r.getOutputs,navigator.requestMIDIAccess(function(r){e=r,n=e.getOutput(0),t&&t()},function(e){console.log("uh-oh! Something went wrong!  Error code: "+e.code)})}}(),"undefined"==typeof MIDI.WebAudioAPI&&(MIDI.WebAudioAPI={}),(window.AudioContext||window.webkitAudioContext)&&function(){var e=window.AudioContext||window.webkitAudioContext,n=MIDI.WebAudioAPI,t,r={},o=1,a={},i=function(e,n,r,o,i){var u=MIDI.GeneralMIDI.byName[e],s=u.number,c=n[r],l=MIDI.Soundfont[e][c].split(",")[1],d=Base64Binary.decodeArrayBuffer(l);t.decodeAudioData(d,function(t){for(var l=c;l.length<3;)l+="&nbsp;";if("undefined"!=typeof MIDI.loader&&MIDI.loader.update(null,u.instrument+"<br>Processing: "+(r/87*100>>0)+"%<br>"+l),t.id=c,o[r]=t,o.length===n.length){for(;o.length;)if(t=o.pop()){var d=MIDI.keyToNote[t.id];a[s+""+d]=t}i(e)}})};n.setVolume=function(e){o=e},n.programChange=function(e,n){MIDI.channels[e].instrument=n},n.noteOn=function(e,n,i,u){if(MIDI.channels[e]){var s=MIDI.channels[e].instrument;if(a[s+""+n]){u<t.currentTime&&(u+=t.currentTime);var c=t.createBufferSource();r[e+""+n]=c,c.buffer=a[s+""+n],c.connect(t.destination);var l=t.createGainNode(),d=i/100*o*2-1;return l.connect(t.destination),l.gain.value=Math.max(-1,d),c.connect(l),c.noteOn(u||0),c}}},n.noteOff=function(e,n,o){o=o||0,o<t.currentTime&&(o+=t.currentTime);var a=r[e+""+n];if(a)return a.gain.linearRampToValueAtTime(1,o),a.gain.linearRampToValueAtTime(0,o+.2),a.noteOff(o+.3),a},n.chordOn=function(e,t,r,o){for(var a={},i,u=0,s=t.length;s>u;u++)a[i=t[u]]=n.noteOn(e,i,r,o);return a},n.chordOff=function(e,t,r){for(var o={},a,i=0,u=t.length;u>i;i++)o[a=t[i]]=n.noteOff(e,a,r);return o},n.connect=function(r){MIDI.technology="Web Audio API",MIDI.setVolume=n.setVolume,MIDI.programChange=n.programChange,MIDI.noteOn=n.noteOn,MIDI.noteOff=n.noteOff,MIDI.chordOn=n.chordOn,MIDI.chordOff=n.chordOff,MIDI.Player.ctx=t=new e;var o=[],a=MIDI.keyToNote;for(var u in a)o.push(u);var s=[],c={},l=function(e){delete c[e];for(var n in c)break;n||r()};for(var d in MIDI.Soundfont){c[d]=!0;for(var f=0;f<o.length;f++)i(d,o,f,s,l)}}}(),window.Audio&&function(){for(var e=MIDI.AudioTag={},n={},t=1,r=-1,o=[],a={},i=0;12>i;i++)o[i]=new Audio;var u=function(e,n){if(MIDI.channels[e]){var i=MIDI.channels[e].instrument,u=MIDI.GeneralMIDI.byId[i].id,n=a[n];if(n){var s=(r+1)%o.length,c=(new Date).getTime(),l=o[s];l.src=MIDI.Soundfont[u][n.id],l.volume=t,l.play(),r=s}}};e.programChange=function(e,n){MIDI.channels[e].instrument=n},e.setVolume=function(e){t=e},e.noteOn=function(e,t,r,o){var i=n[t];if(a[i])return o?window.setTimeout(function(){u(e,i)},1e3*o):void u(e,i)},e.noteOff=function(e,n,t){},e.chordOn=function(e,t,r,o){for(var i in t){var s=t[i],c=n[s];a[c]&&u(e,c)}},e.chordOff=function(e,n,t){},e.stopAllNotes=function(){for(var e=0,n=o.length;n>e;e++)o[e].pause()},e.connect=function(t){var r={};for(var o in MIDI.keyToNote)n[MIDI.keyToNote[o]]=o,a[o]={id:o};MIDI.technology="HTML Audio Tag",MIDI.setVolume=e.setVolume,MIDI.programChange=e.programChange,MIDI.noteOn=e.noteOn,MIDI.noteOff=e.noteOff,MIDI.chordOn=e.chordOn,MIDI.chordOff=e.chordOff,t&&t()}}(),function(){var e=MIDI.Flash={},n={},t={};e.programChange=function(e,n){MIDI.channels[e].instrument=n},e.setVolume=function(e,n){},e.noteOn=function(e,r,o,a){if(MIDI.channels[e]){var i=MIDI.channels[e].instrument,u=MIDI.GeneralMIDI.byId[i].number;if(r=u+""+n[r],t[r])return a?window.setTimeout(function(){t[r].play({volume:2*o})},1e3*a):void t[r].play({volume:2*o})}},e.noteOff=function(e,n,t){},e.chordOn=function(e,r,o,a){if(MIDI.channels[e]){var i=MIDI.channels[e].instrument,u=MIDI.GeneralMIDI.byId[i].number;for(var s in r){var c=r[s],l=u+""+n[c];t[l]&&t[l].play({volume:2*o})}}},e.chordOff=function(e,n,t){},e.stopAllNotes=function(){},e.connect=function(r){soundManager.flashVersion=9,soundManager.useHTML5Audio=!0,soundManager.url="../inc/SoundManager2/swf/",soundManager.useHighPerformance=!0,soundManager.wmode="transparent",soundManager.flashPollingInterval=1,soundManager.debugMode=!1,soundManager.onload=function(){var o=function(e,n,r){var o=MIDI.GeneralMIDI.byName[e],a=o.number;t[a+""+n]=soundManager.createSound({id:n,url:MIDI.soundfontUrl+e+"-mp3/"+n+".mp3",multiShot:!0,autoLoad:!0,onload:r})};for(var a in MIDI.Soundfont)for(var i=[],u=function(){i.push(this.sID),"undefined"!=typeof MIDI.loader&&MIDI.loader.update(null,"Processing: "+this.sID)},s=0;88>s;s++){var c=n[s+21];o(a,c,u)}MIDI.technology="Flash",MIDI.setVolume=e.setVolume,MIDI.programChange=e.programChange,MIDI.noteOn=e.noteOn,MIDI.noteOff=e.noteOff,MIDI.chordOn=e.chordOn,MIDI.chordOff=e.chordOff;var l=window.setInterval(function(){88===i.length&&(window.clearInterval(l),r&&r())},25)},soundManager.onerror=function(){};for(var o in MIDI.keyToNote)n[MIDI.keyToNote[o]]=o}}(),MIDI.GeneralMIDI=function(e){var n=function(e){return e.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},t={byName:{},byId:{},byCategory:{}};for(var r in e)for(var o=e[r],a=0,i=o.length;i>a;a++){var u=o[a];if(u){var s=parseInt(u.substr(0,u.indexOf(" ")),10);u=u.replace(s+" ",""),t.byId[--s]=t.byName[n(u)]=t.byCategory[n(r)]={id:n(u),instrument:u,number:s,category:r}}}return t}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"]}),MIDI.channels=function(){for(var e={},n=0;16>n;n++)e[n]={instrument:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}(),MIDI.pianoKeyOffset=21,MIDI.keyToNote={},MIDI.noteToKey={},function(){for(var e=21,n=108,t=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],r=e;n>=r;r++){var o=(r-12)/12>>0,a=t[r%12]+o;MIDI.keyToNote[a]=r,MIDI.noteToKey[r]=a}}()}(),"undefined"==typeof MIDI)var MIDI={};if("undefined"==typeof MIDI.Player&&(MIDI.Player={}),function(){"use strict";var e=MIDI.Player;e.callback=void 0,e.currentTime=0,e.endTime=0,e.restart=0,e.playing=!1,e.timeWarp=1,e.start=e.resume=function(){e.currentTime<-1&&(e.currentTime=-1),c(e.currentTime)},e.pause=function(){var n=e.restart;l(),e.restart=n},e.stop=function(){l(),e.restart=0,e.currentTime=0},e.addListener=function(e){a=e},e.removeListener=function(){a=void 0},e.clearAnimation=function(){e.interval&&window.clearInterval(e.interval)},e.setAnimation=function(n){var t="function"==typeof n?n:n.callback,r=n.interval||30,a=0,i=0,u=0;e.clearAnimation(),e.interval=window.setInterval(function(){if(0!==e.endTime){e.playing?(a=u===e.currentTime?i-(new Date).getTime():0,a=0===e.currentTime?0:e.currentTime-a,u!==e.currentTime&&(i=(new Date).getTime(),u=e.currentTime)):a=e.currentTime;var n=e.endTime,r=a/n,s=a/1e3,c=s/60,l=s-60*c,d=60*c+l,f=n/1e3;-1>f-d||t({now:d,end:f,events:o})}},r)},e.loadMidiFile=function(){e.replayer=new Replayer(MidiFile(e.currentData),e.timeWarp),e.data=e.replayer.getData(),e.endTime=s()},e.loadFile=function(n,t){if(e.stop(),-1!==n.indexOf("base64,")){var r=window.atob(n.split(",")[1]);return e.currentData=r,e.loadMidiFile(),t&&t(r),void 0}var o=n.split(" - ")[1]||n;document.getElementById("playback-title").innerHTML=o.replace(".mid","");var a=new XMLHttpRequest;a.open("GET",n),a.overrideMimeType("text/plain; charset=x-user-defined"),a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){for(var n=this.responseText||"",r=[],o=n.length,a=String.fromCharCode,i=0;o>i;i++)r[i]=a(255&n.charCodeAt(i));var u=r.join("");e.currentData=u,e.loadMidiFile(),t&&t(u)}},a.send()};var n=[],t,r=0,o={},a=void 0,i=function(n,r,i,u,s,l){var d=window.setTimeout(function(){var u={channel:n,note:r,now:i,end:e.endTime,message:s,velocity:l};128===s?delete o[r]:o[r]=u,a&&a(u),e.currentTime=i,e.currentTime===t&&t<e.endTime&&c(t,!0)},i-u);return d},u=function(){return"WebAudioAPI"===MIDI.lang?MIDI.Player.ctx:(e.ctx||(e.ctx={currentTime:0}),e.ctx)},s=function(){for(var n=e.data,t=n.length,r=.5,o=0;t>o;o++)r+=n[o][1];return r},c=function(o,a){if(e.replayer){a||("undefined"==typeof o&&(o=e.restart),e.playing&&l(),e.playing=!0,e.data=e.replayer.getData(),e.endTime=s());var c,d=0,f=0,I=e.data,A=u(),p=I.length;t=.5,r=A.currentTime;for(var M=0;p>M&&100>f;M++)if(t+=I[M][1],o>t)d=t;else{o=t-d;var m=I[M][0].event;if("channel"===m.type){var g=m.channel;switch(m.subtype){case"noteOn":if(MIDI.channels[g].mute)break;c=m.noteNumber-(e.MIDIOffset||0),n.push({event:m,source:MIDI.noteOn(g,m.noteNumber,m.velocity,o/1e3+A.currentTime),interval:i(g,c,t,d,144,m.velocity)}),f++;break;case"noteOff":if(MIDI.channels[g].mute)break;c=m.noteNumber-(e.MIDIOffset||0),n.push({event:m,source:MIDI.noteOff(g,m.noteNumber,o/1e3+A.currentTime),interval:i(g,c,t,d,128)})}}}}},l=function(){var t=u();for(e.playing=!1,e.restart+=1e3*(t.currentTime-r);n.length;){var i=n.pop();if(window.clearInterval(i.interval),i.source)if("number"==typeof i.source)window.clearTimeout(i.source);else{var s=i.source;s.disconnect(0),s.noteOff(0)}}for(var c in o){var i=o[c];144===o[c].message&&a&&a({channel:i.channel,note:i.note,now:i.now,end:i.end,message:128,velocity:i.velocity})}o={}}}(),"undefined"==typeof DOMLoader)var DOMLoader={};if("undefined"==typeof XMLHttpRequest){var XMLHttpRequest;!function(){for(var e=[function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=0;n<e.length;n++){try{e[n]()}catch(t){continue}break}XMLHttpRequest=e[n]}()}if("undefined"==typeof(new XMLHttpRequest).responseText){var IEBinaryToArray_ByteStr_Script="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n";document.write(IEBinaryToArray_ByteStr_Script),DOMLoader.sendRequest=function(e){function n(e){for(var n={},t=0;256>t;t++)for(var r=0;256>r;r++)n[String.fromCharCode(t+256*r)]=String.fromCharCode(t)+String.fromCharCode(r);var o=IEBinaryToArray_ByteStr(e),a=IEBinaryToArray_ByteStr_Last(e);return o.replace(/[\s\S]/g,function(e){return n[e]})+a}var t=XMLHttpRequest();return t.open("GET",e.url,!0),e.responseType&&(t.responseType=e.responseType),e.onerror&&(t.onerror=e.onerror),e.onprogress&&(t.onprogress=e.onprogress),t.onreadystatechange=function(r){4===t.readyState&&(200===t.status?t.responseText=n(t.responseBody):t=!1,e.onload&&e.onload(t))},t.setRequestHeader("Accept-Charset","x-user-defined"),t.send(null),t}}else DOMLoader.sendRequest=function(e){var n=new XMLHttpRequest;return n.open(e.data?"POST":"GET",e.url,!0),n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),e.data&&n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.responseType&&(n.responseType=e.responseType),e.onerror&&(n.onerror=e.onerror),e.onprogress&&(n.onprogress=e.onprogress),n.onreadystatechange=function(t){if(4===n.readyState){if(200!==n.status&&304!=n.status)return void(e.onerror&&e.onerror(t,!1));e.onload&&e.onload(n)}},n.send(e.data),n};if("undefined"==typeof DOMLoader)var DOMLoader={};!function(){"use strict";DOMLoader.script=function(){return this.loaded={},this.loading={},this},DOMLoader.script.prototype.add=function(e){var n=this;"string"==typeof e&&(e={src:e});var t=e.srcs;"undefined"==typeof t&&(t=[{src:e.src,verify:e.verify}]);var r=document.getElementsByTagName("head")[0],o=function(e,t){n.loaded[e.src]||t&&"undefined"==typeof window[t]||(n.loaded[e.src]=!0,n.loading[e.src]&&n.loading[e.src](),delete n.loading[e.src],e.callback&&e.callback(),"undefined"!=typeof c&&c())},a=[],i=function(t){if("string"==typeof t&&(t={src:t,verify:e.verify}),/([\w\d.])$/.test(t.verify))if(t.test=t.verify,"object"==typeof t.test)for(var i in t.test)a.push(t.test[i]);else a.push(t.test);if(!n.loaded[t.src]){var u=document.createElement("script");u.onreadystatechange=function(){("loaded"===this.readyState||"complete"===this.readyState)&&o(t)},u.onload=function(){o(t)},u.onerror=function(){},u.setAttribute("type","text/javascript"),u.setAttribute("src",t.src),r.appendChild(u),n.loading[t.src]=function(){}}},u=function(n){if(n)o(n,n.test);else for(var r=0;r<t.length;r++)o(t[r],t[r].test);for(var i=!0,r=0;r<a.length;r++){var s=a[r];if(s&&-1!==s.indexOf(".")){s=s.split(".");var c=window[s[0]];if("undefined"==typeof c)continue;2===s.length?"undefined"==typeof c[s[1]]&&(i=!1):3===s.length&&"undefined"==typeof c[s[1]][s[2]]&&(i=!1)}else"undefined"==typeof window[s]&&(i=!1)}!e.strictOrder&&i?e.callback&&e.callback():setTimeout(function(){u(n)},10)};if(e.strictOrder){var s=-1,c=function(){if(s++,t[s]){var r=t[s],o=r.src;n.loading[o]?n.loading[o]=function(){r.callback&&r.callback(),c()}:n.loaded[o]?c():(i(r),u(r))}else e.callback&&e.callback()};c()}else{for(var s=0;s<t.length;s++)i(t[s]);u()}},DOMLoader.script=new DOMLoader.script}();